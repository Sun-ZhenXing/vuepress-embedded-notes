import{u as X,f as S,g as T,h as U,i as K,j as $,k as q,S as _,t as ee,l as te,m as le,n as oe,p as r,R as ne,q as C,s as ae,v as re,x as se,y as ie}from"./app.3adaa376.js";function ue(l){if(Array.isArray(l)){for(var e=0,t=Array(l.length);e<l.length;e++)t[e]=l[e];return t}else return Array.from(l)}var x=!1;if(typeof window<"u"){var j={get passive(){x=!0}};window.addEventListener("testPassive",null,j),window.removeEventListener("testPassive",null,j)}var G=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),g=[],D=!1,B=-1,L=void 0,H=void 0,Y=function(e){return g.some(function(t){return!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))})},M=function(e){var t=e||window.event;return Y(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},ce=function(e){if(H===void 0){var t=!!e&&e.reserveScrollBarGap===!0,o=window.innerWidth-document.documentElement.clientWidth;t&&o>0&&(H=document.body.style.paddingRight,document.body.style.paddingRight=o+"px")}L===void 0&&(L=document.body.style.overflow,document.body.style.overflow="hidden")},de=function(){H!==void 0&&(document.body.style.paddingRight=H,H=void 0),L!==void 0&&(document.body.style.overflow=L,L=void 0)},ve=function(e){return e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1},he=function(e,t){var o=e.targetTouches[0].clientY-B;return Y(e.target)?!1:t&&t.scrollTop===0&&o>0||ve(t)&&o<0?M(e):(e.stopPropagation(),!0)},fe=function(e,t){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!g.some(function(n){return n.targetElement===e})){var o={targetElement:e,options:t||{}};g=[].concat(ue(g),[o]),G?(e.ontouchstart=function(n){n.targetTouches.length===1&&(B=n.targetTouches[0].clientY)},e.ontouchmove=function(n){n.targetTouches.length===1&&he(n,e)},D||(document.addEventListener("touchmove",M,x?{passive:!1}:void 0),D=!0)):ce(t)}},pe=function(){G?(g.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),D&&(document.removeEventListener("touchmove",M,x?{passive:!1}:void 0),D=!1),B=-1):de(),g=[]};const ye="eJyVVMFu2kAU/JWVr8lC7SO3CnpqK0XqsYoqaqxilRrLuJWiCIm0NaIiAiIQomkjaBsimhLTQ5MGm5Cf8e6aU34hJnaCnbCOc7HkfTvzZt7O7iYTZxLeRxXVnMAkGHS8jbQ+mtTJsGXrf1GjMvtWZlYZPi+pgqQWmMTLTSYrpDOCErK7kHv/JhrZenG9uMrElXRBfi0oyoYsQlnk8wFNuLdj15r43xSsOaXb+GVoHvKyHOCYI0EynlxZAWhSQvWdKDSipCphUgDRS5ZZjUL1TuSVvLyhZvPSXV3P58W1q+ID1LkmBelDuFFSG6Gfn3DjCJkG9SDvQ3kHOu8Lnb7wPmpHsT8m55p9sIX3fljmiS8dwVUqGh/1Z4f7C9zNP72f/sX+paGugb8Premefdz2dV1WozNp1dluGekd3B5bZhMZTR/TshqVaXa4bY+2wIvU0wWDuwYLmbdhSOvsnLQG6H+fDKqk1cWVBvo6WJDQyhEumT+UfDYtq4LyiA2kiQyHgAXkT+9isks+ji1DB8+epKgxYmMgsMuT+IqF7jLMCZkwq2yMDVyG5Sl06Fjo0w7DchjdOXfHOec5t0cmqrfx6W9kHKDxCe5MyT79LnExQANcG+BgBMrgaDhnNJZZssYV3BmBx6lkgI6FNzWYzvDhRJz7eLkSUFkjZ7orxJr08OeuEx9U65KG7yF3OnBXg/N0h4Nuzb9YvAShJ982";const I=()=>r(C,{name:"heading"},()=>r("path",{d:"M250.4 704.6H64V595.4h202.4l26.2-166.6H94V319.6h214.4L352 64h127.8l-43.6 255.4h211.2L691 64h126.2l-43.6 255.4H960v109.2H756.2l-24.6 166.6H930v109.2H717L672 960H545.8l43.6-255.4H376.6L333 960H206.8l43.6-255.4zm168.4-276L394 595.4h211.2l24.6-166.6h-211z"}));I.displayName="HeadingIcon";const V=()=>r(C,{name:"heart"},()=>r("path",{d:"M1024 358.156C1024 195.698 892.3 64 729.844 64c-86.362 0-164.03 37.218-217.844 96.49C458.186 101.218 380.518 64 294.156 64 131.698 64 0 195.698 0 358.156 0 444.518 37.218 522.186 96.49 576H96l320 320c32 32 64 64 96 64s64-32 96-64l320-320h-.49c59.272-53.814 96.49-131.482 96.49-217.844zM841.468 481.232 517.49 805.49a2981.962 2981.962 0 0 1-5.49 5.48c-1.96-1.95-3.814-3.802-5.49-5.48L182.532 481.234C147.366 449.306 128 405.596 128 358.156 128 266.538 202.538 192 294.156 192c47.44 0 91.15 19.366 123.076 54.532L512 350.912l94.768-104.378C638.696 211.366 682.404 192 729.844 192 821.462 192 896 266.538 896 358.156c0 47.44-19.368 91.15-54.532 123.076z"}));V.displayName="HeartIcon";const Z=()=>r(C,{name:"history"},()=>r("path",{d:"M512 1024a512 512 0 1 1 512-512 512 512 0 0 1-512 512zm0-896a384 384 0 1 0 384 384 384 384 0 0 0-384-384zm192 448H512a64 64 0 0 1-64-64V320a64 64 0 0 1 128 0v128h128a64 64 0 0 1 0 128z"}));Z.displayName="HistoryIcon";const E=()=>r(C,{name:"title"},()=>r("path",{d:"M512 256c70.656 0 134.656 28.672 180.992 75.008A254.933 254.933 0 0 1 768 512c0 83.968-41.024 157.888-103.488 204.48C688.96 748.736 704 788.48 704 832c0 105.984-86.016 192-192 192-106.048 0-192-86.016-192-192h128a64 64 0 1 0 128 0 64 64 0 0 0-64-64 255.19 255.19 0 0 1-181.056-75.008A255.403 255.403 0 0 1 256 512c0-83.968 41.024-157.824 103.488-204.544C335.04 275.264 320 235.584 320 192A192 192 0 0 1 512 0c105.984 0 192 85.952 192 192H576a64.021 64.021 0 0 0-128 0c0 35.328 28.672 64 64 64zM384 512c0 70.656 57.344 128 128 128s128-57.344 128-128-57.344-128-128-128-128 57.344-128 128z"}));E.displayName="TitleIcon";const me="search-pro-history",m=X(me,[]),ge=(l=5)=>{const e=t=>{m.value.length<l?m.value=Array.from(new Set([t,...m.value])):m.value=Array.from(new Set([...m.value.slice(0,l-1),t]))};return{history:ae(m),addHistory:e}},we=S(ye),Se=T(()=>JSON.parse(re(we.value))),Le={},He=300,ke={"/":{cancel:"取消",placeholder:"搜索",search:"搜索",select:"选择",navigate:"切换",exit:"关闭",history:"搜索历史",emptyHistory:"无搜索历史",emptyResult:"没有找到结果",loading:"正在加载搜索索引..."}},b=(l,e)=>{const t=[];let o=0,n=0;const i=l.toLowerCase(),p=e.toLowerCase();let u=i.indexOf(p,o);const h=(s,c)=>{let a=s,f=!1;if(!c&&a.length>100&&n===0&&(a=`… ${a.slice(-10)}`),n+a.length>100){if(t.some(w=>w[0]==="strong"))return;a=a.slice(0,Math.max(100-n,1)),f=!0}a.length&&(t.push(c?["strong",a]:a),n+=a.length),f&&(t.push("…"),n+=2)};if(u<0)return null;for(;u>=0;){const s=u+p.length;if(h(l.slice(o,u),!1),h(l.slice(u,s),!0),o=s,u=i.indexOf(p,o),n>100)break}return h(l.slice(o),!1),t},z=l=>l.reduce((e,{type:t})=>e+(t==="title"?50:t==="heading"?20:t==="custom"?10:1),0),be=(l,e)=>{var t;const o={};for(const[n,i]of Object.entries(e)){const p=((t=e[n.replace(/\/[^\\]*$/,"")])==null?void 0:t.title)||"",u=`${p?`${p} > `:""}${i.title}`,h=b(i.title,l);h&&(o[u]=[...o[u]||[],{type:"title",path:n,display:h}]),i.customFields&&Object.entries(i.customFields).forEach(([s,c])=>{c.forEach(a=>{const f=b(a,l);f&&(o[u]=[...o[u]||[],{type:"custom",path:n,index:s,display:f}])})});for(const s of i.contents){const c=b(s.header,l);c&&(o[u]=[...o[u]||[],{type:"heading",path:n+(s.slug?`#${s.slug}`:""),display:c}]);for(const a of s.contents){const f=b(a,l);f&&(o[u]=[...o[u]||[],{type:"content",header:s.header||i.title||"Documentation",path:n+(s.slug?`#${s.slug}`:""),display:f}])}}}return Object.keys(o).sort((n,i)=>z(o[n])-z(o[i])).map(n=>({title:n,contents:o[n]}))},Te=l=>{const e=q(),t=S([]),o=T(()=>Se.value[e.value]),n=ie(i=>{t.value=i?be(i,o.value):[]},He);return se([l,e],()=>{n(l.value)}),t};var Me=U({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(l,{emit:e}){const t=K(),o=$(),n=q(),i=_(ke),{history:p,addHistory:u}=ge(),h=ee(l,"query"),s=Te(h),c=S(0),a=S(0),f=S(),w=T(()=>s.value.length>0),A=T(()=>s.value[c.value]||null),N=()=>{c.value=c.value>0?c.value-1:s.value.length-1,a.value=A.value.contents.length-1},Q=()=>{c.value=c.value<s.value.length-1?c.value+1:0,a.value=0},W=()=>{a.value<A.value.contents.length-1?a.value=a.value+1:Q()},P=()=>{a.value>0?a.value=a.value-1:N()},R=d=>d.map(v=>typeof v=="string"?v:r(v[0],v[1])),J=d=>{if(d.type==="custom"){const v=Le[d.index]||"$content",[O,k=""]=typeof v=="object"?v[n.value].split("$content"):v.split("$content");return R([O,...d.display,k])}return R(d.display)};return te(()=>{le("keydown",d=>{if(w.value){if(d.key==="ArrowUp")P();else if(d.key==="ArrowDown")W();else if(d.key==="Enter"){const v=A.value.contents[a.value].path;o.path!==v&&(t.push(v),u(h.value),e("updateQuery",""),e("close"))}}}),fe(f.value,{reserveScrollBarGap:!0})}),oe(()=>{pe()}),()=>r("div",{class:["search-pro-result",{empty:h.value===""?p.value.length===0:!w.value}],ref:f},h.value===""?p.value.length?r("ul",{class:"search-pro-result-list"},p.value.map(d=>r("li",{class:"search-pro-result-list-item"},[r("div",{class:"search-pro-result-title"},i.value.history),r("div",{class:"search-pro-result-item",onClick:()=>{e("updateQuery",d)}},[r(Z,{class:"search-pro-result-type"}),r("div",{class:"search-pro-result-content"},d)])]))):i.value.emptyHistory:w.value?r("ul",{class:"search-pro-result-list"},s.value.map(({title:d,contents:v},O)=>{const k=c.value===O;return r("li",{class:["search-pro-result-list-item",{active:k}]},[r("div",{class:"search-pro-result-title"},d||"Documentation"),v.map((y,F)=>r(ne,{to:y.path,class:["search-pro-result-item",{active:k&&a.value===F}],onClick:()=>{u(h.value),e("updateQuery",""),e("close")}},()=>[y.type==="content"?null:r(y.type==="title"?E:y.type==="heading"?I:V,{class:"search-pro-result-type"}),r("div",{class:"search-pro-result-content"},[y.type==="content"?r("div",{class:"content-header"},y.header):null,r("div",J(y))])]))])})):i.value.emptyResult)}});export{Me as default};
